import{r as a,j as e,A as N,b as w,i as E,k as C,U as S,y as F,L as U,l as O,h as A,m as z,n as q,o as D,p as M}from"./index-BO822pXt.js";import{T as Z}from"./index-CygeEBPU.js";import{P as j}from"./PortalButton-BKR1BTCM.js";import{E as B,P as W}from"./Login-W0Cy0hnI.js";import{v as G}from"./filterForm-BY0rdyPp.js";import{I as H}from"./index-CT16tONM.js";import{P as J}from"./Paginate-BmYTaf8J.js";import"./index-B7Ea7ChQ.js";import"./derechoo-CQXi4tMJ.js";import"./index-zwMgpmri.js";const K=({input:g,setInput:t,inputError:b,setInputError:i,titulo:n="Nombre Completo"})=>{a.useEffect(()=>{c(g)},[]);const c=m=>{const x=m;t(x),x?x.length<3?i(`El ${n} debe tener al menos 3 caracteres`):x.match(/^[A-Za-zÁÉÍÓÚáéíóúÑñÜü'-]+(?:\s[A-Za-zÁÉÍÓÚáéíóúÑñÜü'-]+)*$/)?i(""):i("No es un nombre válido"):i(`El campo ${n} es requerido`)};return e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-2xl dark:text-white",children:n}),e.jsx("input",{type:"text",id:"name",name:"name",value:g,onChange:m=>c(m.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:`Ingrese el ${n}`,required:!0}),b&&e.jsx("p",{className:"text-red-400 text-sm mt-1 lowercase",children:b})]})},Q=({setShowModal:g})=>{const{getToken:t,can:b}=N(),i=w(),{obtenerUsers:n}=E(),{roles:c}=C(),m=t(),[x,k]=a.useState(""),[h,y]=a.useState(""),[u,s]=a.useState(""),[v,r]=a.useState(""),[o,l]=a.useState(""),[d,T]=a.useState(""),[I,V]=a.useState(""),$=p=>{s(p.target.value)};a.useEffect(()=>{b("ver_usuarios")?s(c[0].name):i("/")},[]);const L=async p=>{if(p.preventDefault(),!!G(Object.values({emailError:o,nameError:I,passwordError:d})))try{await S.createUser({name:x,email:h,password:v,role:u},m).then(({data:f})=>{f&&(console.log(f),g(!1),n(1),F.success("El usuario ha sido creado exitosamente"))}).catch(({err:f})=>{console.log("Existe un error "+f)})}catch(f){f.response?(console.error("Server Error:",f.response.data),console.error("Status Code:",f.response.status)):f.request?console.error("Network Error: No response received from the server."):console.error("Error Setting Up Request:",f.message)}};return e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsx(K,{input:x,setInput:k,setInputError:V,inputError:I}),e.jsx(B,{email:h,setEmail:y,emailError:o,setEmailError:l}),e.jsx(W,{password:v,setPassword:r,passwordError:d,setPasswordError:T}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"rol",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Seleccionar un rol"}),e.jsxs("select",{id:"rol",name:"rol",value:u,onChange:p=>$(p),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 capitalize",children:[e.jsx("option",{disabled:!0,defaultValue:"",children:"Escoge un rol"}),c.map(p=>e.jsx("option",{value:p.roleName,children:p.roleName},p.id))]})]}),e.jsx("button",{type:"submit",onClick:L,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Enviar"})]})})},R=({id:g,setShowModal:t})=>{const{getToken:b,can:i}=N(),n=w(),{users:c,obtenerUsers:m}=E(),[x,k]=a.useState([]),h=b();a.useEffect(()=>{i("eliminar_usuarios")||n("/")},[i,n]),a.useEffect(()=>{k(c.find(u=>u.id===g))},[c]);const y=async u=>{u.preventDefault();try{await A.get("/sanctum/csrf-cookie",{withCredentials:!0}),console.log("CSRF token retrieved successfully."),await S.deleteUser(g,h).then(({data:s})=>{s&&(t(!1),m(1),F.success("El usuario ha sido eliminado exitosamente"))}).catch(({err:s})=>{console.log("Existe un error "+s)})}catch(s){s.response?(console.error("Server Error:",s.response.data),console.error("Status Code:",s.response.status)):s.request?console.error("Network Error: No response received from the server."):console.error("Error Setting Up Request:",s.message)}};return x.length<=0?e.jsx("div",{className:"h-[200px]",children:e.jsx(U,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6 flex gap-4 justify-center items-center text-2xl",children:[e.jsx(H,{className:"w-4 h-4 text-red-700"}),e.jsx("label",{htmlFor:"name",className:"block mb-2font-medium text-gray-900 dark:text-white",children:"Eliminar usuario del sistema"})]}),e.jsxs("div",{className:"w-full mb-4 flex gap-2 items-center justify-center",children:[e.jsx(O,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"flex-grow-1 text-gray-900 dark:text-white",children:x.name||""}),e.jsx("input",{type:"email",readOnly:!0,id:"voice-search",value:x.email||"",className:`bg-gray-50 border border-gray-300 text-gray-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block  \r
            p-2.5 flex-grow-1 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500`})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 pt-4",children:[e.jsx("button",{type:"submit",onClick:y,className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800",children:"Eliminar usuario"}),e.jsx("button",{type:"submit",onClick:y,className:"bg-white text-red-700 hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:text-red-600  dark:hover:bg-gray-300 dark:focus:ring-red-800",children:"Eliminar usuario y su contenido"})]})]})})},_=({id:g})=>{const{can:t}=N(),b=w(),{users:i}=E(),[n,c]=a.useState([]);return a.useEffect(()=>{t("ver_usuarios")||b("/")},[t,b]),a.useEffect(()=>{c(i.find(m=>m.id===g))},[i]),n.length<=0?e.jsx("div",{className:"h-[300px]",children:e.jsx(U,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white capitalize",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"name",name:"name",disabled:!0,value:n.name||"",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",disabled:!0,value:n.email||"",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roles",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Rol"}),e.jsx("input",{type:"text",value:n.role||"",id:"roles",disabled:!0,name:"roles",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 capitalize",required:!0})]})]})})},P=({id:g,setShowModal:t})=>{const{getToken:b,can:i}=N(),n=w(),{roles:c}=C(),{users:m,obtenerUsers:x}=E(),k=b(),[h,y]=a.useState([]);a.useEffect(()=>{i("actualizar_usuarios")||n("/")},[i,n]);const u=(r,o)=>{y(l=>({...l,[r]:o}))},s=r=>{u(r.target.name,r.target.value)};a.useEffect(()=>{y(m.find(r=>r.id===g))},[m]);const v=async r=>{r.preventDefault();try{await A.get("/sanctum/csrf-cookie",{withCredentials:!0});const o=Object.fromEntries(Object.entries(h).filter(([l,d])=>d!=null&&d!==""&&d!=="all"));await S.updateUser(g,{...o},k).then(({data:l})=>{l&&(t(!1),x(1),F.success("La información del usuario se ha actualizado exitosamente"))}).catch(({err:l})=>{console.log("Existe un error "+l)})}catch(o){o.response?(console.error("Server Error:",o.response.data),console.error("Status Code:",o.response.status)):o.request?console.error("Network Error: No response received from the server."):console.error("Error Setting Up Request:",o.message)}};return h.length<=0?e.jsx("div",{className:"h-[400px]",children:e.jsx(U,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"name",name:"name",value:h.name||"",onChange:r=>s(r),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:h.email||"",onChange:r=>s(r),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Contraseña"}),e.jsx("input",{type:"password",value:h.password||"",id:"password",name:"password",onChange:r=>s(r),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"•••••••••",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"rol",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Seleccionar un rol"}),e.jsxs("select",{id:"role",name:"role",value:h.role||"",onChange:r=>s(r),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 capitalize",children:[e.jsx("option",{disabled:!0,defaultValue:"",value:"",children:"Escoge un rol"}),c.map(r=>e.jsx("option",{value:r.roleName,children:r.roleName},r.id))]})]}),e.jsx("button",{type:"submit",onClick:v,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Actualizar información"})]})})},de=()=>{const{getToken:g,can:t}=N(),b=w(),[i,n]=a.useState(!0);g(),a.useEffect(()=>{t("ver_usuarios")?n(!1):b("/")},[t,b]);const{users:c,pageCount:m,obtenerUsers:x,totalUser:k,current:h}=E(),[y,u]=a.useState(1),{roles:s}=C(),v=r=>{const o=Math.min(r.selected+1,m);x(o)};return e.jsxs("div",{className:"md:px-10 px-2 pt-4",children:[e.jsxs("div",{className:"mx-0 my-4 md:mx-4 py-4 px-0 md:px-4 flex flex-row gap-4 md:justify-between justify-center flex-wrap",children:[e.jsx("div",{className:"md:text-3xl text-2xl font-extrabold dark:text-white",children:"Lista de usuarios"}),t("crear_usuarios")&&e.jsx("div",{children:e.jsx(j,{name:"Crear nuevo usuario",Icon:Z,title:"Crear usuario",content:(r,o)=>e.jsx(Q,{setCounter:u,roles:s,showModal:r,setShowModal:o})})})]}),e.jsx("div",{className:"md:p-8",children:c&&c.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative overflow-x-auto mx-auto",children:[e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 hidden md:table",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 capitalize",children:"Rol"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Acción"})]})}),e.jsx("tbody",{children:c.map((r,o)=>e.jsxs("tr",{className:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx("th",{scope:"row",className:"px-6 py-4",children:r.id}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white capitalize",children:r.name}),e.jsx("td",{className:"px-6 py-4",children:r.email}),e.jsx("td",{className:"px-6 py-4 capitalize",children:r.role}),e.jsxs("td",{className:"px-6 py-4 flex flex-row gap-2 items-center",children:[t("eliminar_usuarios")&&e.jsx("div",{children:e.jsx(j,{Icon:z,color:"red",content:(l,d)=>e.jsx(R,{setCounter:u,id:r.id,showModal:l,setShowModal:d})})}),t("ver_usuario")&&e.jsx("div",{children:e.jsx(j,{Icon:q,color:"green",title:"Ver usuario",content:(l,d)=>e.jsx(_,{setCounter:u,id:r.id,showModal:l,setShowModal:d})})}),t("actualizar_usuarios")&&e.jsx("div",{children:e.jsx(j,{Icon:D,title:"Editar usuario",color:"yellow",content:(l,d)=>e.jsx(P,{setCounter:u,roles:s,id:r.id,showModal:l,setShowModal:d})})})]})]},o))})]}),e.jsx("div",{className:"flex flex-col gap-4 md:hidden text-gray-800 dark:text-gray-400",children:c.map((r,o)=>e.jsxs("div",{className:"p-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-md",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:r.nombre}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",r.id]}),e.jsx("a",{className:"flex items-center justify-center gap-2 mt-2 mb-2",children:e.jsx(M,{className:"h-24 w-24"})}),e.jsx("div",{className:"text-md text-center",children:r.name}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Email:"})," ",r.email]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Rol:"})," ",e.jsx("span",{className:"uppercase",children:r.role})]}),e.jsxs("div",{className:"mt-2 flex gap-4 justify-center",children:[t("eliminar_usuarios")&&e.jsx("div",{children:e.jsx(j,{Icon:z,color:"red",name:"Eliminar",content:(l,d)=>e.jsx(R,{setCounter:u,id:r.id,showModal:l,setShowModal:d})})}),t("actualizar_usuarios")&&e.jsx("div",{children:e.jsx(j,{Icon:D,name:"Editar",color:"yellow",content:(l,d)=>e.jsx(P,{setCounter:u,roles:s,id:r.id,showModal:l,setShowModal:d})})}),t("ver_usuarios")&&e.jsx("div",{children:e.jsx(j,{Icon:q,color:"green",title:"Ver usuario",name:"Ver",content:(l,d)=>e.jsx(_,{setCounter:u,id:r.id,showModal:l,setShowModal:d})})})]})]},o))})]}),e.jsx(J,{handlePageClick:v,totalCount:k,pageCount:m,actualPage:h})]})})]})};export{de as default};
