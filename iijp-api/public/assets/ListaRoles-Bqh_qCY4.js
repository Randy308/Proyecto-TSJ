import{A as E,b as S,r as d,k as C,j as e,L as F,q as V,h as U,R as L,y as z,s as $,m as q,n as D,o as P}from"./index-BO822pXt.js";import{T as O}from"./index-CygeEBPU.js";import{P as N}from"./PortalButton-BKR1BTCM.js";import{I as W}from"./index-CT16tONM.js";import"./Login-W0Cy0hnI.js";import"./index-B7Ea7ChQ.js";import"./derechoo-CQXi4tMJ.js";const A=({id:f,setCounter:c,showModal:y,setShowModal:v})=>{const{getToken:h,can:p}=E(),i=S(),[x,g]=d.useState(!0),[s,u]=d.useState([]),{roles:t,obtenerRoles:a}=C(),m=h();d.useEffect(()=>{p("eliminar_roles")?g(!1):i("/")},[p,i]),d.useEffect(()=>{u(t.find(k=>k.id===f))},[t]);const w=async k=>{k.preventDefault();try{await U.get("/sanctum/csrf-cookie",{withCredentials:!0}),console.log("CSRF token retrieved successfully."),await L.deleteRole(f,m).then(({data:r})=>{r&&(console.log(r),v(!1),a(),c(n=>n+1),z.success("El rol ha sido eliminado exitosamente"))}).catch(({err:r})=>{console.log("Existe un error "+r)})}catch(r){r.response?(console.error("Server Error:",r.response.data),console.error("Status Code:",r.response.status)):r.request?console.error("Network Error: No response received from the server."):console.error("Error Setting Up Request:",r.message)}};return s.length<=0?e.jsx("div",{className:"h-[200px]",children:e.jsx(F,{})}):e.jsx("div",{className:"container mx-auto pt-6 mt-6 max-w-4xl",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xl text-red-700",children:[e.jsx(W,{className:"w-6 h-6"}),e.jsx("h2",{className:"text-3xl font-semibold dark:text-white",children:"Eliminar Rol del Sistema"})]}),e.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-gray-300",children:"Asegúrese de que desea eliminar este rol. Esta acción no se puede deshacer."})]}),e.jsxs("div",{className:"mb-6 flex gap-4 justify-center items-center",children:[e.jsx(V,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),e.jsx("input",{type:"text",readOnly:!0,id:"role-name",name:"roleName",value:s.roleName||"",className:"bg-gray-50 border border-gray-300 text-gray-700 text-sm rounded-lg focus:ring-red-500 focus:border-red-500 block p-3 w-full sm:w-[400px] dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:focus:ring-red-500 dark:focus:border-red-500"})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx("button",{type:"submit",onClick:w,className:"w-full sm:w-auto text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-6 py-3 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800",children:"Eliminar Rol"})})]})})},T=({id:f,permissions:c,setCounter:y,showModal:v,setShowModal:h})=>{const{getToken:p,can:i}=E(),x=S(),[g,s]=d.useState(!0);p();const[u,t]=d.useState([]),{roles:a}=C();return d.useEffect(()=>{i("ver_rol")?s(!1):x("/")},[i,x]),d.useEffect(()=>{t(a.find(m=>m.id===f))},[a]),u.length<=0?e.jsx("div",{className:"h-[400px]",children:e.jsx(F,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roleName",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",value:u.roleName||"",disabled:!0,onChange:m=>actualizarInput(m),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{children:e.jsx("span",{className:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Lista de permisos"})}),e.jsx("ul",{className:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownSearchButton",children:c&&c.filter(m=>u.permissions.includes(m.id)).map(m=>e.jsx("li",{children:e.jsxs("label",{className:"inline-flex items-center mb-5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",value:m.id,disabled:!0,checked:!0,className:"sr-only peer"}),e.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:m.name})]})},m.id))})]})]})})},M=({id:f,permissions:c,setCounter:y,showModal:v,setShowModal:h})=>{const{getToken:p,can:i}=E(),x=S(),[g,s]=d.useState(!0),u=p(),[t,a]=d.useState([]),{roles:m,obtenerRoles:w}=C();d.useEffect(()=>{i("actualizar_roles")?s(!1):x("/")},[i,x]);const k=(o,l)=>{a(b=>({...b,[o]:l}))},r=o=>{k(o.target.name,o.target.value)},n=o=>{const{value:l,checked:b}=o.target,R=parseInt(l,10);a(I=>{const _=I.permissions;return b?{...I,permissions:[..._,R]}:{...I,permissions:_.filter(B=>B!==R)}})};d.useEffect(()=>{a(m.find(o=>o.id===f))},[m]);const j=async o=>{o.preventDefault();try{await U.get("/sanctum/csrf-cookie",{withCredentials:!0}),console.log("CSRF token retrieved successfully."),await L.updateRole(f,{...t},u).then(({data:l})=>{l&&(console.log(l),h(!1),w(),y(b=>b+1),z.success("La información del rol ha sido actualizado exitosamente"))}).catch(({err:l})=>{console.log("Existe un error "+l)})}catch(l){l.response?(console.error("Server Error:",l.response.data),console.error("Status Code:",l.response.status)):l.request?console.error("Network Error: No response received from the server."):console.error("Error Setting Up Request:",l.message)}};return t.length<=0?e.jsx("div",{className:"h-[400px]",children:e.jsx(F,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roleName",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",value:t.roleName||"",onChange:o=>r(o),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{children:e.jsx("span",{className:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Lista de permisos"})}),e.jsx("ul",{className:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownSearchButton",children:c.map(o=>e.jsx("li",{children:e.jsxs("label",{className:"inline-flex items-center my-2 cursor-pointer",children:[e.jsx("input",{id:`checkbox-item-${o.name}`,type:"checkbox",value:o.id,checked:t.permissions&&t.permissions.includes(o.id)||!1,onChange:l=>n(l),className:"sr-only peer"}),e.jsx("div",{className:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:o.name})]})},o.id))})]}),e.jsx("button",{type:"submit",onClick:j,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Actualizar información"})]})})},G=({setCounter:f,permissions:c,showModal:y,setShowModal:v})=>{const{getToken:h,can:p}=E(),i=S(),[x,g]=d.useState(!0);h();const[s,u]=d.useState([]),{obtenerRoles:t}=C();d.useEffect(()=>{p("crear_roles")?g(!1):i("/")},[p,i]);const a=(r,n)=>{u(j=>({...j,[r]:n}))},m=r=>{a(r.target.name,r.target.value)},w=r=>{const{value:n,checked:j}=r.target,o=parseInt(n,10);u(l=>{const b=Array.isArray(l.permissions)?l.permissions:[];return j?{...l,permissions:[...b,o]}:{...l,permissions:b.filter(R=>R!==o)}})},k=async r=>{r.preventDefault();try{await L.createRole({...s}).then(({data:n})=>{n&&(console.log(n),v(!1),f(j=>j+1),t(),z.success("El rol ha sido creado exitosamente"))}).catch(({err:n})=>{console.log("Existe un error "+n)})}catch(n){n.response?(console.error("Server Error:",n.response.data),console.error("Status Code:",n.response.status)):n.request?console.error("Network Error: No response received from the server."):console.error("Error Setting Up Request:",n.message)}};return e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roleName",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre del rol"}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",value:s.roleName||"",onChange:r=>m(r),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{children:e.jsx("span",{className:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Lista de permisos"})}),e.jsx("ul",{className:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownSearchButton",children:c.map(r=>e.jsx("li",{children:e.jsxs("label",{className:"inline-flex items-center my-2 cursor-pointer",children:[e.jsx("input",{id:`checkbox-item-${r.name}`,type:"checkbox",value:r.id,checked:s.permissions&&s.permissions.includes(r.id)||!1,onChange:n=>w(n),className:"sr-only peer"}),e.jsx("div",{className:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:r.name})]})},r.id))})]}),e.jsx("button",{type:"submit",onClick:k,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Crear rol"})]})})},ee=()=>{const{getToken:f,can:c}=E(),y=S(),[v,h]=d.useState(!0);f();const[p,i]=d.useState(1),{roles:x}=C(),{permisos:g}=$();return d.useEffect(()=>{c("ver_roles")?h(!1):y("/")},[c,y]),e.jsxs("div",{className:"md:px-20 px-2",children:[e.jsxs("div",{className:"container mx-auto my-4 p-4 flex flex-row gap-4 md:justify-between justify-center flex-wrap",children:[e.jsx("div",{className:"text-3xl font-extrabold dark:text-white",children:"Lista de roles"}),c("crear_roles")&&e.jsx("div",{children:e.jsx(N,{name:"Crear nuevo rol",Icon:O,title:"Crear rol",content:(s,u)=>e.jsx(G,{setCounter:i,permissions:g,showModal:s,setShowModal:u})})})]}),e.jsx("div",{className:"md:p-8",children:x&&x.length>0&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative container overflow-x-auto mx-auto",children:[e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 hidden md:table",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Acción"})]})}),e.jsx("tbody",{children:x.map((s,u)=>e.jsxs("tr",{className:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx("th",{scope:"row",className:"px-6 py-4",children:s.id}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white capitalize",children:s.roleName}),e.jsxs("td",{className:"px-6 py-4 flex flex-row gap-2 items-center",children:[c("eliminar_roles")&&e.jsx("div",{children:e.jsx(N,{Icon:q,color:"red",content:(t,a)=>e.jsx(A,{setCounter:i,id:s.id,showModal:t,setShowModal:a})})}),c("ver_rol")&&e.jsx("div",{children:e.jsx(N,{Icon:D,color:"green",title:"Ver usuario",content:(t,a)=>e.jsx(T,{setCounter:i,id:s.id,permissions:g,showModal:t,setShowModal:a})})}),c("actualizar_roles")&&e.jsx("div",{children:e.jsx(N,{Icon:P,title:"Editar usuario",color:"yellow",content:(t,a)=>e.jsx(M,{setCounter:i,id:s.id,permissions:g,showModal:t,setShowModal:a})})})]})]},u))})]}),e.jsx("div",{className:"flex flex-col gap-4 md:hidden",children:x.map((s,u)=>e.jsxs("div",{className:"p-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-md",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["ID: ",s.id]}),e.jsx("div",{className:"text-lg capitalize font-bold text-gray-900 dark:text-white text-center",children:s.roleName}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-4 justify-center",children:[c("eliminar_roles")&&e.jsx("div",{children:e.jsx(N,{Icon:q,color:"red",name:"Eliminar",content:(t,a)=>e.jsx(A,{setCounter:i,id:s.id,showModal:t,setShowModal:a})})}),c("ver_rol")&&e.jsx("div",{children:e.jsx(N,{Icon:D,color:"green",title:"Ver rol",name:"Ver rol",content:(t,a)=>e.jsx(T,{setCounter:i,id:s.id,permissions:g,showModal:t,setShowModal:a})})}),c("actualizar_roles")&&e.jsx("div",{children:e.jsx(N,{Icon:P,title:"Editar rol",name:"Editar rol",color:"yellow",content:(t,a)=>e.jsx(M,{setCounter:i,id:s.id,permissions:g,showModal:t,setShowModal:a})})})]})]},u))})]})})})]})};export{ee as default};
