import{u as ne,r as a,j as e,x as ce,V as ie,b as de,Q as v,y as j,W as ue,P as xe,K as q,E as me,X as he}from"./index-CD8CbPwS.js";import{f as y,a as ge,b as pe,c as fe}from"./filterForm-BY0rdyPp.js";import{F as be}from"./Filtros-BXVUL0f4.js";import{P as je}from"./PortalButton-CdFt-TFv.js";import{P as Ne}from"./Paginate-yQKV7Oks.js";import{R as ve}from"./ResolucionTSJ-BMmXDX-W.js";import{A as ye}from"./AsyncButton-uaaMPnEN.js";import{u as ke}from"./Icons-QOAE5RoN.js";import"./Login-BrorGFWg.js";import"./index-CMepVOqn.js";import"./derechoo-CQXi4tMJ.js";import"./index-Czl2LD_p.js";const Me=()=>{const{data:k}=ne(),h=40,[T,w]=a.useState(!1),O=a.useMemo(()=>e.jsx(ce,{className:"w-4 h-4 "}),[]),z=a.useMemo(()=>e.jsx(ie,{className:"w-4 h-4"}),[]),[N,C]=a.useState([]),[S,_]=a.useState(""),[H,J]=a.useState([]),[g,I]=a.useState(!0),[p,R]=a.useState({subtitulo:"",seccion:!1}),U=de(),[A,F]=a.useState(1),[Q,V]=a.useState(1),[G,P]=a.useState(1),[K,D]=a.useState(1),[i,L]=a.useState([]),{removeAllIcon:W,checkAllIcon:X}=ke(),[we,B]=a.useState(!1),[l,f]=a.useState([]),[E,n]=a.useState(""),[c,M]=a.useState(""),[d,u]=a.useState([]),$=s=>!!(/^[a-zA-ZáéíóúÁÉÍÓÚñÑ0-9\s'’-]+$/.test(s)||s===""),Y=s=>{const r=s.target.value;$(r)?(M(r),n("")):n("No se permiten caracteres especiales")},Z=s=>{C(Number.parseInt(s.descriptor_id)),_(s.descriptor),u([]),R(r=>({...r,materia:[Number.parseInt(s.root_id)]}))},ee=async s=>{if(s.preventDefault(),l.length<=0){j.error("Debe agregar resoluciones");return}const r=y({descriptor:N,ids:l,materia:g,...p});w(!0),v.obtenerCronologiabyIds(r).then(({data:o})=>{console.log(o);const t=new Blob([o],{type:"application/pdf"}),x=URL.createObjectURL(t);U("/Jurisprudencia/Cronologias/Resultados",{state:{pdfUrl:x}})}).catch(o=>{const t=o.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",t)}).finally(()=>{w(!1)})},se=async()=>{if(!$(c))return;if(g){b();return}if(c.length<1){n("Debe ingresar un término de búsqueda");return}const s=y({busqueda:c});try{v.searchTermino(s).then(({data:r})=>{r.length>0?(u(r),n("")):(n("No se encontraron resultados"),u([]))}).catch(({err:r})=>{console.log("Existe un error "+r),n("No se encontraron resultados"),u([])})}catch(r){const o=r.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",o),console.error("Error :",r)}};a.useEffect(()=>{b()},[p]);const b=async(s=1)=>{const r=s&&!isNaN(s)&&s>0?s:1,o=y({busqueda:c,page:r,descriptor:N,...p});L([]),F(1),P(1),D(1),v.obtenerResoluciones(o).then(t=>{t.data.data.length>0?(L(t.data.data),J(ge(t.data.facets,k)),F(t.data.last_page),P(t.data.last_page),D(t.data.total)):j.warning("No existen datos")}).catch(t=>{const x=t.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",x)}).finally(()=>{B(!1)})},re=s=>{const r=Math.min(s,A);V(s),b(r)},te=s=>{const r=Number(s.target.value);f(o=>o.includes(r)?o.filter(t=>t!==r):l.length>=h?(j.error(`No puede seleccionar más de ${h} resoluciones. Por favor, deseleccione algunas antes de continuar.`),o):[...o,r])},ae=s=>{s.preventDefault();const o=i.map(m=>Number(m.resolution_id)).filter(m=>!l.includes(m)),t=h-l.length;if(t<=0){j.error("Ya alcanzaste el límite de resoluciones seleccionadas");return}const x=o.slice(0,t);f(m=>{const le=new Set([...m,...x]);return Array.from(le)}),B(!0)},oe=s=>{s.preventDefault(),f(r=>r.filter(o=>!i.some(t=>Number(t.resolution_id)===o)))};return e.jsxs("div",{id:"cronologia-container",className:"sm:p-4 sm:m-4 m-2 p-2",children:[e.jsx("div",{className:"header-container",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-bold text-3xl text-center my-4 titulo uppercase font-bold text-black dark:text-white",children:"Generación de Cronojurídicas"}),e.jsx("div",{className:"flex justify-end items-center flex-wrap gap-4 mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"voice-search",value:c,onChange:s=>Y(s),className:"bg-gray-50 h-full border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-red-octopus-500 focus:border-red-octopus-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-red-octopus-500 dark:focus:border-red-octopus-500",placeholder:"Búsqueda de jurisprudencia....",required:!0}),c.length>0&&e.jsx("a",{className:"absolute inset-y-0 end-0 flex items-center justify-center pe-3 hover:cursor-pointer",onClick:()=>M(""),children:e.jsx(ue,{})})]}),e.jsxs("button",{type:"button",onClick:()=>se(),className:"flex items-center bg-red-octopus-600 p-4 text-white rounded-lg hover:bg-red-octopus-700 focus:ring-4 focus:ring-red-octopus-300 dark:focus:ring-red-octopus-800",children:[O," "]}),i.length>0&&e.jsxs("button",{type:"button",onClick:()=>b(),className:"flex items-center bg-red-octopus-600 p-4 text-white rounded-lg hover:bg-red-octopus-700 focus:ring-4 focus:ring-red-octopus-300 dark:focus:ring-red-octopus-800",children:[z," "]})]}),e.jsxs("div",{className:"flex flex-row flex-wrap items-center md:justify-end gap-4 mt-2 text-lg text-black dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center",children:[" ",e.jsx("input",{type:"radio",value:"res",id:"checkbox-res",checked:g,onChange:()=>I(!0),className:"peer"}),e.jsx("label",{htmlFor:"checkbox-res",children:"Buscar resoluciones"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"desc",id:"checkbox-desc",checked:!g,onChange:()=>I(!1),className:"peer"}),e.jsx("label",{htmlFor:"checkbox-desc",children:"Buscar descriptores"})]})]})]})})]})}),e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"w-full",children:E.length>0&&e.jsxs("div",{id:"alert-2",className:"flex items-center p-4 mb-4 text-red-800 rounded-lg  dark:bg-gray-800 dark:text-red-400",role:"alert",children:[e.jsx(xe,{className:"shrink-0 w-4 h-4"}),e.jsx("div",{className:"ms-3 text-sm font-medium",children:E})]})})}),N&&S&&e.jsx("div",{className:"py-4 flex items-center justify-end gap-4 flex-wrap",children:e.jsxs("div",{className:"text-sm flex flex-row items-center flex-wrap gap-2",children:[e.jsx("span",{className:"text-black dark:text-white",children:"Descriptor:"}),e.jsxs("div",{onClick:()=>C(null)&&_(""),className:"bg-white group flex gap-4 items-center justify-between hover:cursor-pointer rounded-lg p-2 font-bold m-4 border hover:border-red-500 text-xs dark:bg-gray-500",children:[e.jsx("span",{children:S}),e.jsx(q,{className:"group-hover:text-red-500"})]})]})}),l&&l.length>0&&e.jsxs("div",{className:"py-4 flex items-center justify-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"text-sm flex flex-row items-center flex-wrap gap-2",children:[e.jsx("span",{className:"text-black dark:text-white",children:"Resoluciones seleccionadas:"}),e.jsxs("div",{onClick:()=>f([]),className:"bg-white group flex gap-4 items-center justify-between hover:cursor-pointer rounded-lg p-2 font-bold m-4 border hover:border-red-500 text-xs dark:bg-gray-500",children:[e.jsxs("span",{children:[l.length+"/"+h," "]}),e.jsx(q,{className:"group-hover:text-red-500"})]})]}),e.jsx(ye,{asyncFunction:ee,name:"Obtener Resoluciones",isLoading:T,full:!1})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-4 pt-4",children:d&&d.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-800 rounded-md p-3 my-2",children:[e.jsxs("span",{children:["La búsqueda genero:"," ",d.length>1?d.length+" resultados":"un resultado"]}),e.jsx("span",{onClick:()=>u([]),className:"cursor-pointer underline",children:"Limpiar Resultados"})]}),d.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 hover:dark:bg-gray-700 hover:bg-gray-200 rounded-md p-3 my-2 cursor-pointer transition-all ease-in-out duration-200",onClick:()=>Z(s),children:[e.jsx("span",{className:"text-black font-semibold dark:text-white ",children:s.descriptor}),e.jsx("span",{className:"text-gray-600 text-sm dark:text-gray-400",children:s.cantidad})]},r))]}):e.jsxs("div",{className:"flex flex-row flex-wrap gap-4",children:[e.jsx("div",{className:"lg:w-auto w-full",children:Object.entries(H).map(([s,r])=>e.jsx(be,{nombre:s,data:r,formData:p,setFormData:R},s))}),e.jsx("div",{className:"lg:flex-1",children:e.jsx(e.Fragment,{children:i.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative overflow-x-auto space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e.jsxs("a",{onClick:s=>ae(s),className:"dark:bg-gray-800 dark:border-gray-700 inline-flex items-center justify-between border hover:cursor-pointer border-gray-200 p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700",children:[X,e.jsx("span",{className:"ms-2 text-xs",children:"Seleccionar todos"})]}),e.jsxs("a",{onClick:s=>oe(s),className:"dark:bg-gray-800 dark:border-gray-700 inline-flex items-center border hover:cursor-pointer border-gray-200 p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group",children:[W,e.jsx("span",{className:"ms-2 text-xs",children:"Quitar Selección"})]})]}),e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:i.map((s,r)=>e.jsxs("div",{className:`relative p-6 rounded-2xl bg-white dark:bg-gray-900 shadow-md border-2 hover:shadow-lg transition ${l.includes(Number(s.resolution_id))?"border-blue-400 dark:border-blue-900":"border-gray-100"}`,children:[e.jsx("input",{type:"checkbox",id:`checkbox-${s.resolution_id}`,value:s.resolution_id,checked:l.includes(Number(s.resolution_id)),onChange:te,className:"hidden peer","aria-label":`Seleccionar resolución ${s.nro_resolucion}`}),l.includes(Number(s.resolution_id))?e.jsx("label",{htmlFor:`checkbox-${s.resolution_id}`,className:"hover:cursor-pointer text-blue-700",children:e.jsx(me,{className:"h-7 w-7"})}):e.jsx("label",{htmlFor:`checkbox-${s.resolution_id}`,className:"hover:cursor-pointer text-gray-400 dark:text-gray-500",children:e.jsx(he,{className:"h-7 w-7"})}),e.jsx("div",{className:"mt-2 flex justify-center text-center text-xl",children:e.jsx(je,{withIcon:!1,title:"Auto Supremo",name:`${pe(s.tipo_resolucion,"tipo_resolucion",k)} Nº${fe(s.nro_resolucion)}`,color:"link",full:!1,large:!0,content:o=>e.jsx(ve,{id:s.resolution_id})})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-700 dark:text-gray-300",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Periodo:"})," ",s.periodo]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ratio:"}),e.jsx("div",{className:"pl-2 mt-1 border-l-4 border-blue-500 dark:border-blue-400",dangerouslySetInnerHTML:{__html:s.ratio}})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Descriptor:"}),e.jsx("div",{className:"pl-2 mt-1 border-l-4 border-green-500 dark:border-green-400",dangerouslySetInnerHTML:{__html:s.descriptor}})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Restrictor:"}),e.jsx("div",{className:"pl-2 mt-1 border-l-4 border-red-500 dark:border-red-400",dangerouslySetInnerHTML:{__html:s.restrictor}})]})]})]})]},r))})]}),e.jsx("div",{className:"mt-6",children:e.jsx(Ne,{handlePageClick:re,pageCount:G,actualPage:Q,totalCount:K,lastPage:A})})]})})})]})}),e.jsx("div",{})]})]})};export{Me as default};
