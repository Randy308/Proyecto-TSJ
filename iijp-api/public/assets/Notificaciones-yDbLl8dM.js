import{q as w,u as k,j as f,U as j}from"./index-CS51DAse.js";import{t as d,c as v,n as M,g as b,a as S,e as I,m as p,b as x,d as X}from"./es-DEYhgeyP.js";function D(t,r){const n=+d(t)-+d(r);return n<0?-1:n>0?1:n}function _(t){return v(t,Date.now())}function O(t,r,n){const[a,e]=M(n?.in,t,r),c=a.getFullYear()-e.getFullYear(),o=a.getMonth()-e.getMonth();return c*12+o}function T(t){return r=>{const a=(t?Math[t]:Math.trunc)(r);return a===0?0:a}}function Y(t,r){return+d(t)-+d(r)}function A(t,r){const n=d(t,r?.in);return n.setHours(23,59,59,999),n}function F(t,r){const n=d(t,r?.in),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}function z(t,r){const n=d(t,r?.in);return+A(n,r)==+F(n,r)}function C(t,r,n){const[a,e,c]=M(n?.in,t,t,r),o=D(e,c),s=Math.abs(O(e,c));if(s<1)return 0;e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-o*s);let u=D(e,c)===-o;z(a)&&s===1&&D(a,c)===1&&(u=!1);const h=o*(s-+u);return h===0?0:h}function H(t,r,n){const a=Y(t,r)/1e3;return T(n?.roundingMethod)(a)}function L(t,r,n){const a=S(),e=n?.locale??a.locale??I,c=2520,o=D(t,r);if(isNaN(o))throw new RangeError("Invalid time value");const s=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:o}),[u,h]=M(n?.in,...o>0?[r,t]:[t,r]),m=H(h,u),N=(b(h)-b(u))/1e3,i=Math.round((m-N)/60);let g;if(i<2)return n?.includeSeconds?m<5?e.formatDistance("lessThanXSeconds",5,s):m<10?e.formatDistance("lessThanXSeconds",10,s):m<20?e.formatDistance("lessThanXSeconds",20,s):m<40?e.formatDistance("halfAMinute",0,s):m<60?e.formatDistance("lessThanXMinutes",1,s):e.formatDistance("xMinutes",1,s):i===0?e.formatDistance("lessThanXMinutes",1,s):e.formatDistance("xMinutes",i,s);if(i<45)return e.formatDistance("xMinutes",i,s);if(i<90)return e.formatDistance("aboutXHours",1,s);if(i<p){const l=Math.round(i/60);return e.formatDistance("aboutXHours",l,s)}else{if(i<c)return e.formatDistance("xDays",1,s);if(i<x){const l=Math.round(i/p);return e.formatDistance("xDays",l,s)}else if(i<x*2)return g=Math.round(i/x),e.formatDistance("aboutXMonths",g,s)}if(g=C(h,u),g<12){const l=Math.round(i/x);return e.formatDistance("xMonths",l,s)}else{const l=g%12,y=Math.trunc(g/12);return l<3?e.formatDistance("aboutXYears",y,s):l<9?e.formatDistance("overXYears",y,s):e.formatDistance("almostXYears",y+1,s)}}function R(t,r){return L(t,_(t),r)}const $=()=>{const{notifications:t,setNotifications:r}=w(),{hasAccess:n}=k();if(!n())return null;const a=async e=>{const c=(t||[]).find(o=>o.id===e);if(!c){console.warn(`No se encontró notificación con ID ${e}`);return}if(c.estado!=="unread"){console.log(`La notificación con ID ${e} ya está leída`);return}r(o=>(o||[]).map(s=>s.id===e?{...s,estado:"read"}:s));try{await j.markNotificationAsRead(e)}catch(o){console.error("Error marcando notificación como leída:",o),r(s=>(s||[]).map(u=>u.id===e?{...u,estado:"unread"}:u))}};return f.jsx("div",{children:t&&t.length>0?f.jsxs("div",{id:"user-dropdown",className:"z-50 my-4 text-base list-none ",children:[f.jsx("p",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Notificaciones recientes:"}),f.jsx("ul",{className:"py-2 flex flex-col gap-4","aria-labelledby":"user-menu-button",children:t.length>0?t.map((e,c)=>f.jsxs("li",{className:`px-4 py-2  h-20 flex flex-col  justify-around text-xs bg-white rounded-lg shadow dark:bg-gray-700 dark:divide-gray-600  ${e.estado==="unread"?"text-gray-700 dark:text-gray-200 dark:hover:bg-gray-600 dark:hover:text-white hover:cursor-pointer hover:bg-gray-100":"text-gray-500"}`,onClick:()=>a(e.id),children:[f.jsx("p",{children:e.mensaje}),f.jsx("span",{className:"text-red-octopus-900 dark:text-blue-700",children:R(new Date(e.created_at),{addSuffix:!0,locale:X})})]},c)):f.jsx("li",{className:"block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white",children:"No hay notificaciones"})})]}):f.jsx("p",{className:"p-4 my-4 text-xl text-gray-600 bg-white dark:bg-gray-900 rounded-lg shadow-lg",children:"No existen notificaciones recientes"})})};export{$ as default};
