import{r as l,j as e,u as j,c as k,h as v,i as P,U as w,y as E,k as C,L as N,l as V,m as U,n as _,o as I,p as L}from"./index-CS51DAse.js";import{T as $}from"./index-B-h8Bjto.js";import{P as y}from"./PortalButton-C9pukmzI.js";import{E as T,P as Z}from"./Login-DbIr_fTM.js";import{v as B}from"./filterForm-qRQJ7N12.js";import{I as W}from"./index-DBXxcIRH.js";import{P as G}from"./Paginate-CeUBiUk8.js";import"./index-Bjhrrt2E.js";import"./index-BBE9PvKj.js";const H=({input:s,setInput:x,inputError:u,setInputError:d,titulo:a="Nombre Completo"})=>{l.useEffect(()=>{i(s)},[s]);const i=c=>{const n=c;x(n),n?n.length<3?d(`El ${a} debe tener al menos 3 caracteres`):n.match(/^[A-Za-zÁÉÍÓÚáéíóúÑñÜü'-]+(?:\s[A-Za-zÁÉÍÓÚáéíóúÑñÜü'-]+)*$/)?d(""):d("No es un nombre válido"):d(`El campo ${a} es requerido`)};return e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-2xl dark:text-white",children:a}),e.jsx("input",{type:"text",id:"name",name:"name",value:s,onChange:c=>i(c.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:`Ingrese el ${a}`,required:!0}),u&&e.jsx("p",{className:"text-red-400 text-sm mt-1 lowercase",children:u})]})},J=({setShowModal:s})=>{const{can:x}=j(),u=k(),{obtenerUsers:d}=v(),{roles:a}=P(),[i,c]=l.useState(""),[n,h]=l.useState(""),[f,r]=l.useState(""),[g,t]=l.useState(""),[o,b]=l.useState(""),[S,R]=l.useState(""),[F,A]=l.useState(""),M=p=>{r(p.target.value)};l.useEffect(()=>{x("ver_usuarios")?a&&a.length>0&&r(a[0].roleName):u("/")},[a]);const O=async p=>{if(p.preventDefault(),!!B(Object.values({emailError:o,nameError:F,passwordError:S})))try{await w.createUser({name:i,email:n,password:g,role:f}).then(({data:m})=>{m&&(console.log(m),s(!1),d(1),E.success("El usuario ha sido creado exitosamente"))}).catch(({err:m})=>{console.log("Existe un error "+m)})}catch(m){m instanceof C.AxiosError?(console.error("Server Error:",m.response?.data),console.error("Status Code:",m.response?.status)):typeof m=="object"&&m!==null&&"request"in m?console.error("Network Error: No response received from the server."):typeof m=="object"&&m!==null&&"message"in m&&console.error("Error Setting Up Request:",m.message)}};return e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsx(H,{input:i,setInput:c,setInputError:A,inputError:F}),e.jsx(T,{email:n,setEmail:h,emailError:o,setEmailError:b}),e.jsx(Z,{password:g,setPassword:t,passwordError:S,setPasswordError:R}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"rol",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Seleccionar un rol"}),e.jsxs("select",{id:"rol",name:"rol",value:f,onChange:p=>M(p),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 capitalize",children:[e.jsx("option",{disabled:!0,defaultValue:"",children:"Escoge un rol"}),a&&a.map(p=>e.jsx("option",{value:p.roleName,children:p.roleName},p.id))]})]}),e.jsx("button",{type:"submit",onClick:()=>O,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Enviar"})]})})},z=({id:s,setShowModal:x})=>{const{can:u}=j(),d=k(),{users:a,obtenerUsers:i}=v(),[c,n]=l.useState({});l.useEffect(()=>{u("eliminar_usuarios")||d("/")},[u,d]),l.useEffect(()=>{a&&n(a.find(f=>f.id===s)||{})},[s,a]);const h=async f=>{f.preventDefault();try{await w.deleteUser(s).then(({data:r})=>{r&&(x(!1),i(1),E.success("El usuario ha sido eliminado exitosamente"))}).catch(({err:r})=>{console.log("Existe un error "+r)})}catch(r){r instanceof C.AxiosError?(console.error("Server Error:",r.response?.data),console.error("Status Code:",r.response?.status)):typeof r=="object"&&r!==null&&"request"in r?console.error("Network Error: No response received from the server."):typeof r=="object"&&r!==null&&"message"in r&&console.error("Error Setting Up Request:",r.message)}};return c===null||Object.keys(c).length===0?e.jsx("div",{className:"h-[200px]",children:e.jsx(N,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6 flex gap-4 justify-center items-center text-2xl",children:[e.jsx(W,{className:"w-4 h-4 text-red-700"}),e.jsx("label",{htmlFor:"name",className:"block mb-2font-medium text-gray-900 dark:text-white",children:"Eliminar usuario del sistema"})]}),e.jsxs("div",{className:"w-full mb-4 flex gap-2 items-center justify-center",children:[e.jsx(V,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),e.jsx("span",{className:"flex-grow-1 text-gray-900 dark:text-white",children:c.name||""}),e.jsx("input",{type:"email",readOnly:!0,id:"voice-search",value:c.email||"",className:`bg-gray-50 border border-gray-300 text-gray-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block  \r
            p-2.5 flex-grow-1 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500`})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 pt-4",children:[e.jsx("button",{type:"submit",onClick:h,className:"text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800",children:"Eliminar usuario"}),e.jsx("button",{type:"submit",onClick:h,className:"bg-white text-red-700 hover:bg-gray-200 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:text-red-600  dark:hover:bg-gray-300 dark:focus:ring-red-800",children:"Eliminar usuario y su contenido"})]})]})})},q=({id:s})=>{const{can:x}=j(),u=k(),{users:d}=v(),[a,i]=l.useState({});return l.useEffect(()=>{x("ver_usuarios")||u("/")},[x,u]),l.useEffect(()=>{d&&i(d.find(c=>c.id===s)||{})},[s,d]),Object.keys(a).length<=0?e.jsx("div",{className:"h-[300px]",children:e.jsx(N,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white capitalize",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"name",name:"name",disabled:!0,value:a.name||"",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",disabled:!0,value:a.email||"",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roles",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Rol"}),e.jsx("input",{type:"text",value:a.role||"",id:"roles",disabled:!0,name:"roles",className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 capitalize",required:!0})]})]})})},D=({id:s,setShowModal:x})=>{const{can:u}=j(),d=k(),{roles:a}=P(),{users:i,obtenerUsers:c}=v(),[n,h]=l.useState({});l.useEffect(()=>{u("actualizar_usuarios")||d("/")},[u,d]);const f=(t,o)=>{h(b=>({...b,[t]:o}))},r=t=>{f(t.target.name,t.target.value)};l.useEffect(()=>{i&&h(i.find(t=>t.id===s)||{})},[s,i]);const g=async t=>{t.preventDefault();try{const o=Object.fromEntries(Object.entries(n).filter(([b])=>b!=null&&b!==""&&b!=="all"));await w.updateUser(s,{...o}).then(({data:b})=>{b&&(x(!1),c(1),E.success("La información del usuario se ha actualizado exitosamente"))}).catch(({err:b})=>{console.log("Existe un error "+b)})}catch(o){o instanceof C.AxiosError?(console.error("Server Error:",o.response?.data),console.error("Status Code:",o.response?.status)):typeof o=="object"&&o!==null&&"request"in o?console.error("Network Error: No response received from the server."):typeof o=="object"&&o!==null&&"message"in o&&console.error("Error Setting Up Request:",o.message)}};return n===null||Object.keys(n).length<=0?e.jsx("div",{className:"h-[400px]",children:e.jsx(N,{})}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"name",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"name",name:"name",value:n.name||"",onChange:t=>r(t),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"email",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:n.email||"",onChange:t=>r(t),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"password",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Contraseña"}),e.jsx("input",{type:"password",value:n.password||"",id:"password",name:"password",onChange:t=>r(t),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"•••••••••",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"rol",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Seleccionar un rol"}),e.jsxs("select",{id:"role",name:"role",value:n.role||"",onChange:t=>r(t),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 capitalize",children:[e.jsx("option",{disabled:!0,defaultValue:"",value:"",children:"Escoge un rol"}),a&&a.map(t=>e.jsx("option",{value:t.roleName,children:t.roleName},t.id))]})]}),e.jsx("button",{type:"submit",onClick:g,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Actualizar información"})]})})},oe=()=>{const{can:s}=j(),x=k(),[u,d]=l.useState(!0);l.useEffect(()=>{s("ver_usuarios")?d(!1):x("/")},[s,x]);const{users:a,pageCount:i,obtenerUsers:c,totalUser:n,current:h}=v(),f=r=>{const g=Math.min(r||1,i);c(g)};return u?e.jsx(N,{}):e.jsxs("div",{className:"md:px-10 px-2 pt-4",children:[e.jsxs("div",{className:"mx-0 my-4 md:mx-4 py-4 px-0 md:px-4 flex flex-row gap-4 md:justify-between justify-center flex-wrap",children:[e.jsx("div",{className:"md:text-3xl text-2xl font-extrabold dark:text-white",children:"Lista de usuarios"}),s("crear_usuarios")&&e.jsx("div",{children:e.jsx(y,{name:"Crear nuevo usuario",Icon:$,title:"Crear usuario",content:(r,g)=>e.jsx(J,{setShowModal:g})})})]}),e.jsx("div",{className:"md:p-8",children:a&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative overflow-x-auto mx-auto",children:[e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 hidden md:table",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 capitalize",children:"Rol"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Acción"})]})}),e.jsx("tbody",{children:a.map((r,g)=>e.jsxs("tr",{className:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx("th",{scope:"row",className:"px-6 py-4",children:r.id}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white capitalize",children:r.name}),e.jsx("td",{className:"px-6 py-4",children:r.email}),e.jsx("td",{className:"px-6 py-4 capitalize",children:r.roleName}),e.jsxs("td",{className:"px-6 py-4 flex flex-row gap-2 items-center",children:[s("eliminar_usuarios")&&e.jsx("div",{children:e.jsx(y,{Icon:U,color:"red",content:(t,o)=>e.jsx(z,{id:r.id,setShowModal:o})})}),s("ver_usuario")&&e.jsx("div",{children:e.jsx(y,{Icon:_,color:"green",title:"Ver usuario",content:()=>e.jsx(q,{id:r.id})})}),s("actualizar_usuarios")&&e.jsx("div",{children:e.jsx(y,{Icon:I,title:"Editar usuario",color:"yellow",content:(t,o)=>e.jsx(D,{id:r.id,setShowModal:o})})})]})]},g))})]}),e.jsx("div",{className:"flex flex-col gap-4 md:hidden text-gray-800 dark:text-gray-400",children:a.map((r,g)=>e.jsxs("div",{className:"p-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-md",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",r.id]}),e.jsx("a",{className:"flex items-center justify-center gap-2 mt-2 mb-2",children:e.jsx(L,{className:"h-24 w-24"})}),e.jsx("div",{className:"text-md text-center",children:r.name}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Email:"})," ",r.email]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("strong",{children:"Rol:"})," ",e.jsx("span",{className:"uppercase",children:r.roleName})]}),e.jsxs("div",{className:"mt-2 flex gap-4 justify-center",children:[s("eliminar_usuarios")&&e.jsx("div",{children:e.jsx(y,{Icon:U,color:"red",name:"Eliminar",content:(t,o)=>e.jsx(z,{id:r.id,setShowModal:o})})}),s("actualizar_usuarios")&&e.jsx("div",{children:e.jsx(y,{Icon:I,name:"Editar",color:"yellow",content:(t,o)=>e.jsx(D,{id:r.id,setShowModal:o})})}),s("ver_usuarios")&&e.jsx("div",{children:e.jsx(y,{Icon:_,color:"green",title:"Ver usuario",name:"Ver",content:()=>e.jsx(q,{id:r.id})})})]})]},g))})]}),e.jsx(G,{handlePageClick:f,totalCount:n,pageCount:i,actualPage:h})]})})]})};export{oe as default};
