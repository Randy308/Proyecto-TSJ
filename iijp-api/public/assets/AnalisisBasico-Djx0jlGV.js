import{G as O,D as U,b as W,r as a,u as _,C as b,j as e,L as $}from"./index-CD8CbPwS.js";import{S as q}from"./SimpleChart-CrW7fS2S.js";import{T as J,i as Q,a as Z}from"./arrayUtils-CsLRBPY6.js";import{S as ee,a as w}from"./Select-BAFyNfyX.js";import{A as te}from"./AsyncButton-uaaMPnEN.js";import{a as ae}from"./filterForm-BY0rdyPp.js";import"./dark-DiTyuMna.js";import"./MultiBtnDropdown-Chd7r9XF.js";import"./Icons-QOAE5RoN.js";import"./index-Czl2LD_p.js";import"./index-CMepVOqn.js";function re(d){return O({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M8 3 4 7l4 4"},child:[]},{tag:"path",attr:{d:"M4 7h16"},child:[]},{tag:"path",attr:{d:"m16 21 4-4-4-4"},child:[]},{tag:"path",attr:{d:"M20 17H4"},child:[]}]})(d)}const xe=()=>{const d=U(),N=W(),o=d.state?.data,n=d.state?.validatedData,[s,p]=a.useState(null),[x,C]=a.useState([]),[A,m]=a.useState({}),[f,L]=a.useState(null),[E,V]=a.useState(null),[D,g]=a.useState(),[k,M]=a.useState(!0),[X,j]=a.useState(!1),[se,T]=a.useState("Nombre"),[z,v]=a.useState(!1),{data:B}=_(),y=a.useMemo(()=>f,[f]),[F,le]=a.useState(1),[u,I]=a.useState([]),[S,Y]=a.useState(!1),[i,h]=a.useState([]),G=t=>{const l=[];for(let c=0;c<t;c++)l.push({type:"bar",seriesLayoutBy:"column"});return l};a.useEffect(()=>{s&&s.length>0&&m({legend:{},tooltip:{trigger:"item"},grid:{containLabel:!0},dataset:{source:s},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0},yAxis:{},series:G(s[0].length-1)})},[s]);const P=t=>{g(t),m(l=>w(l,t.toLowerCase()))},R=()=>{Y(t=>!t)},H=()=>{v(!0);const t=u.length>0,l=t?{...n,variableY:u[0].ids,nombreY:u[0].name}:{...n};(t?b.realizarAnalisisXY(l):b.realizarAnalisis(l)).then(({data:r})=>{console.log("Datos cargados desde API",r),r&&(p(r.data.length>0?r.data:[]),j(r.multiVariable),h(r.data.length>0?Z(r.data):[]))}).catch(r=>{console.error("Error fetching data:",r)}).finally(()=>{g("bar"),v(!1)})},K=()=>{g("column"),m(t=>w(t,"column",!0)),h(Q(i))};return a.useEffect(()=>{if(i&&i.length>0){let t=i[0];V(t.map((l,c)=>({accessorKey:c.toString(),header:l.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()),enableSorting:!0})))}console.log(i)},[i]),a.useEffect(()=>{n&&b.obtenerFiltrosEstadisticos(n).then(t=>{t.data&&L(ae(t.data,B))}).catch(t=>{console.log("Existe un error "+t)})},[n]),a.useEffect(()=>{if(o===null||!Array.isArray(o.data))N("/estadisticas-basicas");else{const t=o.data.length>0?o.data:[];p(t),h(t),C(o.columna),j(o.multiVariable),T(o.nombre)}},[o]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-1 p-2 m-2 lg:grid-cols-5",children:[e.jsxs("div",{className:"p-4 border border-gray-300 dark:border-gray-950 bg-white dark:bg-gray-600 rounded-lg shadow-lg",children:[x&&e.jsxs("p",{className:"text-black dark:text-white pb-4",children:["Variable observada:",e.jsxs("span",{className:"italic font-bold capitalize",children:[" ",x]})]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"charts",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Tipo de gráficos"}),e.jsxs("select",{id:"charts",value:D,onChange:t=>P(t.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e.jsx("option",{disabled:!0,defaultValue:!0,children:"Elige un tipo de gráfico"}),e.jsx("option",{value:"bar",children:"Barras"}),e.jsx("option",{value:"column",children:"Columnas"}),e.jsx("option",{value:"area",children:"Área"}),X?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"stacked-bar",children:"Barras Apiladas"}),e.jsx("option",{value:"stacked-column",children:"Columnas Apiladas"})]}):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"pie",children:"Circular"}),e.jsx("option",{value:"donut",children:"Dona"})]})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"inline-flex items-center flex-wrap-reverse cursor-pointer m-4",children:[e.jsx("input",{type:"checkbox",checked:S,onChange:()=>R(),className:"sr-only peer"}),e.jsx("div",{className:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-xs font-medium text-gray-900 dark:text-gray-300",children:"Cruce por una variable"})]})}),e.jsxs("div",{className:` ${S?"":"hidden"}  `,children:[e.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Variables"}),y&&e.jsx(ee,{memoizedParams:y,limite:F,listaX:u,setListaX:I}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2 pb-2",children:[e.jsxs("button",{type:"button",onClick:()=>K(),className:"inline-flex items-center text-white bg-red-octopus-700 hover:bg-red-octopus-600 dark:bg-blue-700 dark:hover:bg-blue-600  font-medium rounded-lg text-sm px-5 py-3 text-center",children:[e.jsx(re,{className:"fill-current w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs",children:"Intercambio X-Y"})]}),e.jsx(te,{name:"Analizar",asyncFunction:H,isLoading:z,full:!1})]})]})]}),s&&s.length>0?e.jsx("div",{className:"max-w-sm mx-auto mt-4",children:e.jsx("button",{onClick:()=>M(t=>!t),type:"button",className:"w-full mt-2 text-white bg-red-octopus-600 dark:bg-blue-600 hover:bg-red-octopus-800 hover:dark:bg-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2",children:k?"Mostrar Tabla ":"Mostrar Grafico"})}):""]}),s&&s.length>0?e.jsx("div",{className:"lg:col-span-4 md:col-span-3",children:k?e.jsx(q,{option:A}):e.jsx(J,{data:i.slice(1),columns:E})}):e.jsx("div",{children:e.jsx($,{})})]})};export{xe as default};
