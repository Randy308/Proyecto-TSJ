import{u as w,c as E,r as d,i as R,j as e,L as b,a4 as U,k as S,a5 as C,y as F,a6 as B,m as L,n as _,o as z}from"./index-CS51DAse.js";import{T as O}from"./index-B-h8Bjto.js";import{P as k}from"./PortalButton-C9pukmzI.js";import{I as V}from"./index-DBXxcIRH.js";import"./Login-DbIr_fTM.js";import"./index-Bjhrrt2E.js";const A=({id:o,setShowModal:g})=>{const{can:p}=w(),m=E(),[x,f]=d.useState(!0),[r,i]=d.useState({}),{roles:a,obtenerRoles:s}=R();d.useEffect(()=>{p("eliminar_roles")?f(!1):m("/")},[p,m]),d.useEffect(()=>{const j=(a||[]).find(n=>n.id===o);i(j||{})},[o,a]);const y=async j=>{j.preventDefault();try{await S.get("/sanctum/csrf-cookie",{withCredentials:!0}),console.log("CSRF token retrieved successfully."),await C.deleteRole(o).then(({data:n})=>{n&&(console.log(n),g(!1),s(),F.success("El rol ha sido eliminado exitosamente"))}).catch(({err:n})=>{console.log("Existe un error "+n)})}catch(n){n instanceof S.AxiosError?(console.error("Server Error:",n.response?.data),console.error("Status Code:",n.response?.status)):typeof n=="object"&&n!==null&&"request"in n?console.error("Network Error: No response received from the server."):typeof n=="object"&&n!==null&&"message"in n&&console.error("Error Setting Up Request:",n.message)}};return Object.keys(r).length<=0?e.jsx("div",{className:"h-[200px]",children:e.jsx(b,{})}):x?e.jsx(b,{}):e.jsx("div",{className:"container mx-auto pt-6 mt-6 max-w-4xl",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xl text-red-700",children:[e.jsx(V,{className:"w-6 h-6"}),e.jsx("h2",{className:"text-3xl font-semibold dark:text-white",children:"Eliminar Rol del Sistema"})]}),e.jsx("p",{className:"mt-2 text-lg text-gray-600 dark:text-gray-300",children:"Asegúrese de que desea eliminar este rol. Esta acción no se puede deshacer."})]}),e.jsxs("div",{className:"mb-6 flex gap-4 justify-center items-center",children:[e.jsx(U,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),e.jsx("input",{type:"text",readOnly:!0,id:"role-name",name:"roleName",value:r.roleName||"",className:"bg-gray-50 border border-gray-300 text-gray-700 text-sm rounded-lg focus:ring-red-500 focus:border-red-500 block p-3 w-full sm:w-[400px] dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:focus:ring-red-500 dark:focus:border-red-500"})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsx("button",{type:"submit",onClick:()=>y,className:"w-full sm:w-auto text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-6 py-3 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800",children:"Eliminar Rol"})})]})})},q=({id:o,permissions:g})=>{const{can:p}=w(),m=E(),[x,f]=d.useState(!0),[r,i]=d.useState({}),{roles:a}=R();return d.useEffect(()=>{p("ver_rol")?f(!1):m("/")},[p,m]),d.useEffect(()=>{const s=(a||[]).find(y=>y.id===o);i(s||{})},[o,a]),Object.keys(r).length<=0?e.jsx("div",{className:"h-[200px]",children:e.jsx(b,{})}):x?e.jsx(b,{}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roleName",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",value:r.roleName||"",disabled:!0,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{children:e.jsx("span",{className:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Lista de permisos"})}),e.jsx("ul",{className:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownSearchButton",children:g&&(g||[]).filter(s=>Array.isArray(r.permissions)&&r.permissions.includes(s.id)).map(s=>e.jsx("li",{children:e.jsxs("label",{className:"inline-flex items-center mb-5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",value:s.id,disabled:!0,checked:!0,className:"sr-only peer"}),e.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:s.name})]})},s.id))})]})]})})},D=({id:o,permissions:g,setShowModal:p})=>{const{can:m}=w(),x=E(),[f,r]=d.useState(!0),[i,a]=d.useState({}),{roles:s,obtenerRoles:y}=R();d.useEffect(()=>{m("actualizar_roles")?r(!1):x("/")},[m,x]);const j=(l,t)=>{a(h=>({...h,[l]:t}))},n=l=>{j(l.target.name,l.target.value)},c=l=>{const{value:t,checked:h}=l.target,N=parseInt(t,10);a(v=>{const I=v.permissions;return h?{...v,permissions:[...I||[],N]}:{...v,permissions:(I||[]).filter(P=>P!==N)}})};d.useEffect(()=>{const l=(s||[]).find(t=>t.id===o);a(l||{})},[o,s]);const u=async l=>{l.preventDefault();try{await S.get("/sanctum/csrf-cookie",{withCredentials:!0}),console.log("CSRF token retrieved successfully."),await C.updateRole(o,{...i}).then(({data:t})=>{t&&(console.log(t),p(!1),y(),F.success("La información del rol ha sido actualizado exitosamente"))}).catch(({err:t})=>{console.log("Existe un error "+t)})}catch(t){t instanceof S.AxiosError?(console.error("Server Error:",t.response?.data),console.error("Status Code:",t.response?.status)):typeof t=="object"&&t!==null&&"request"in t?console.error("Network Error: No response received from the server."):typeof t=="object"&&t!==null&&"message"in t&&console.error("Error Setting Up Request:",t.message)}};return Object.keys(i).length<=0?e.jsx("div",{className:"h-[200px]",children:e.jsx(b,{})}):f?e.jsx(b,{}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roleName",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre completo"}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",value:i.roleName||"",onChange:l=>n(l),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{children:e.jsx("span",{className:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Lista de permisos"})}),e.jsx("ul",{className:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownSearchButton",children:g&&g.map(l=>e.jsx("li",{children:e.jsxs("label",{className:"inline-flex items-center my-2 cursor-pointer",children:[e.jsx("input",{id:`checkbox-item-${l.name}`,type:"checkbox",value:l.id,checked:i.permissions&&i.permissions.includes(l.id)||!1,onChange:t=>c(t),className:"sr-only peer"}),e.jsx("div",{className:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:l.name})]})},l.id))})]}),e.jsx("button",{type:"submit",onClick:()=>u,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Actualizar información"})]})})},$=({permissions:o,setShowModal:g})=>{const{can:p}=w(),m=E(),[x,f]=d.useState(!0),[r,i]=d.useState({}),{obtenerRoles:a}=R();d.useEffect(()=>{p("crear_roles")?f(!1):m("/")},[p,m]);const s=(c,u)=>{i(l=>({...l,[c]:u}))},y=c=>{s(c.target.name,c.target.value)},j=c=>{const{value:u,checked:l}=c.target,t=parseInt(u,10);i(h=>{const N=Array.isArray(h.permissions)?h.permissions:[];return l?{...h,permissions:[...N,t]}:{...h,permissions:N.filter(v=>v!==t)}})},n=async c=>{c.preventDefault();try{await C.createRole({...r}).then(({data:u})=>{u&&(console.log(u),g(!1),a(),F.success("El rol ha sido creado exitosamente"))}).catch(({err:u})=>{console.log("Existe un error "+u)})}catch(u){console.error("Error Setting Up Request:",u)}};return x?e.jsx(b,{}):e.jsx("div",{className:"container mx-auto pt-4 mt-4",children:e.jsxs("form",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"roleName",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Nombre del rol"}),e.jsx("input",{type:"text",id:"roleName",name:"roleName",value:r.roleName||"",onChange:c=>y(c),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:!0})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{children:e.jsx("span",{className:"w-full py-3 ms-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Lista de permisos"})}),e.jsx("ul",{className:"h-48 px-3 pb-3 overflow-y-auto text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownSearchButton",children:(o||[]).map(c=>e.jsx("li",{children:e.jsxs("label",{className:"inline-flex items-center my-2 cursor-pointer",children:[e.jsx("input",{id:`checkbox-item-${c.name}`,type:"checkbox",value:c.id,checked:r.permissions&&r.permissions.includes(c.id)||!1,onChange:u=>j(u),className:"sr-only peer"}),e.jsx("div",{className:"relative w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"}),e.jsx("span",{className:"ms-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:c.name})]})},c.id))})]}),e.jsx("button",{type:"submit",onClick:()=>n,className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"Crear rol"})]})})};function K(){const{can:o}=w(),g=E(),[p,m]=d.useState(!0),{roles:x}=R(),{permisos:f}=B();return d.useEffect(()=>{o("ver_roles")?m(!1):g("/")},[o,g]),p?e.jsx(b,{}):e.jsxs("div",{className:"md:px-20 px-2",children:[e.jsxs("div",{className:"container mx-auto my-4 p-4 flex flex-row gap-4 md:justify-between justify-center flex-wrap",children:[e.jsx("div",{className:"text-3xl font-extrabold dark:text-white",children:"Lista de roles"}),o("crear_roles")&&e.jsx("div",{children:e.jsx(k,{name:"Crear nuevo rol",Icon:O,title:"Crear rol",content:(r,i)=>e.jsx($,{permissions:f,showModal:r,setShowModal:i})})})]}),e.jsx("div",{className:"md:p-8",children:x&&x.length>0&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative container overflow-x-auto mx-auto",children:[e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400 hidden md:table",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Nombre"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Acción"})]})}),e.jsx("tbody",{children:x.map((r,i)=>e.jsxs("tr",{className:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx("th",{scope:"row",className:"px-6 py-4",children:r.id}),e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white capitalize",children:r.roleName}),e.jsxs("td",{className:"px-6 py-4 flex flex-row gap-2 items-center",children:[o("eliminar_roles")&&e.jsx("div",{children:e.jsx(k,{Icon:L,color:"red",content:(a,s)=>e.jsx(A,{id:r.id,showModal:a,setShowModal:s})})}),o("ver_rol")&&e.jsx("div",{children:e.jsx(k,{Icon:_,color:"green",title:"Ver usuario",content:(a,s)=>e.jsx(q,{id:r.id,permissions:f,showModal:a,setShowModal:s})})}),o("actualizar_roles")&&e.jsx("div",{children:e.jsx(k,{Icon:z,title:"Editar usuario",color:"yellow",content:(a,s)=>e.jsx(D,{id:r.id,permissions:f,showModal:a,setShowModal:s})})})]})]},i))})]}),e.jsx("div",{className:"flex flex-col gap-4 md:hidden",children:x.map((r,i)=>e.jsxs("div",{className:"p-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 shadow-md",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["ID: ",r.id]}),e.jsx("div",{className:"text-lg capitalize font-bold text-gray-900 dark:text-white text-center",children:r.roleName}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-4 justify-center",children:[o("eliminar_roles")&&e.jsx("div",{children:e.jsx(k,{Icon:L,color:"red",name:"Eliminar",content:(a,s)=>e.jsx(A,{id:r.id,showModal:a,setShowModal:s})})}),o("ver_rol")&&e.jsx("div",{children:e.jsx(k,{Icon:_,color:"green",title:"Ver rol",name:"Ver rol",content:(a,s)=>e.jsx(q,{id:r.id,permissions:f,showModal:a,setShowModal:s})})}),o("actualizar_roles")&&e.jsx("div",{children:e.jsx(k,{Icon:z,title:"Editar rol",name:"Editar rol",color:"yellow",content:(a,s)=>e.jsx(D,{id:r.id,permissions:f,showModal:a,setShowModal:s})})})]})]},i))})]})})})]})}export{K as ListaRoles};
