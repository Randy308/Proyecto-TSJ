import{r as o,b as I,j as e,u as D,Q as E,S as R,C as q}from"./index-DfKAKSSO.js";import{a as A}from"./index-CvxPIX6S.js";import{u as F}from"./useSessionStorage-BciEVf3a.js";import{S as G}from"./SimpleChart-CfrclA1U.js";import{A as O}from"./AsyncButton-DiTkpQVw.js";import{G as T}from"./GeoChart-gSylieSJ.js";import{f as L}from"./filterForm-BY0rdyPp.js";import"./dark-CE_-lrH1.js";import"./Icons-AMBJMzXu.js";import"./index-DbfdK6-c.js";const P=({item:l,removeItemById:g,data:c})=>{const[y,x]=o.useState(!1),[u,v]=o.useState(!0),[j,k]=o.useState([]);sessionStorage.removeItem("formData"),F("formData",{tipo_resolucion:"all",sala:"all",magistrado:"all",departamento:"all",forma_resolucion:"all",tipo_jurisprudencia:"all",materia:"all"});const C=I(),w=(t,s="/proyeccion")=>{C(s,{state:{parametros:t}})},p=t=>{const s=t.replace(/_/g," de ");return s.charAt(0).toUpperCase()+s.slice(1)},b=t=>{let s={};return Object.entries(t).forEach(([m,N])=>{if(c[m]){const h=c[m].find(f=>String(f.id)===N);h&&(s[m]=h.nombre)}}),s};return o.useEffect(()=>{k(b(l.detalles))},[]),e.jsxs("div",{className:"w-full max-w-sm bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-end px-4 pt-4",children:[e.jsx("button",{id:"dropdownButton",onClick:()=>x(t=>!t),"data-dropdown-toggle":"dropdown",className:"inline-block text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:ring-4 focus:outline-none focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-1.5",type:"button",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsx("div",{id:"dropdown",onMouseLeave:()=>x(!1),className:`z-10 text-base absolute list-none bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700 ${y?"":"hidden"}`,children:e.jsxs("ul",{className:"py-2","aria-labelledby":"dropdownButton",children:[e.jsx("li",{children:e.jsx("a",{onClick:()=>w(l.detalles,"/jurisprudencia/avanzado"),className:"hover:cursor-pointer block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white",children:"Realizar análisis"})}),e.jsx("li",{children:e.jsx("a",{onClick:()=>g(l.id),className:"hover:cursor-pointer block px-4 py-2 text-sm text-red-600 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white",children:"Eliminar"})})]})})]}),e.jsxs("div",{className:"flex flex-col items-center pb-10",children:[e.jsx("h5",{className:"mb-1 text-lg font-medium text-gray-900 dark:text-white",children:l.value}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Termino de búsqueda"}),e.jsx("div",{className:"text-gray-400 dark:text-gray-300 text-xs mt-2",children:Object.entries(j).map(([t,s])=>e.jsxs("div",{children:[e.jsx("span",{className:"bold",children:p(t)}),": ",s]},t))})]})]})},W=()=>{const[l,g]=o.useState(null),[c,y]=o.useState([]),{data:x}=D(),[u,v]=o.useState([]),[j,k]=o.useState({}),[C,w]=o.useState({}),[p,b]=o.useState(!1),[t,s]=o.useState({campo:"proceso",busqueda:"proceso"});o.useEffect(()=>{l&&k({title:{text:"Cantidad de resoluciones a lo largo del tiempo",padding:[20,20,10,20]},tooltip:{trigger:"axis"},legend:{data:l.map(r=>r.name),padding:[20,20,10,20]},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"time",boundaryGap:!1},yAxis:{type:"value"},series:l.map(r=>r),grid:{top:"10%",bottom:"10%",left:"10%",right:"10%"}})},[l]);const m=async()=>{if(p)return;b(!0);const r=L(t);w(a=>({...a,[r.campo]:r.busqueda})),q.obtenerElemento({...r}).then(a=>{a.data.resoluciones.data.length>0?(g(n=>n?[...n,a.data.resoluciones]:[a.data.resoluciones]),v(n=>n.length>0?[...n,a.data.termino]:[a.data.termino]),f()):alert("No existen datos")}).catch(a=>{console.error("Error fetching data:",a)}).finally(()=>{b(!1)})},N=r=>{g(d=>d.filter(i=>i.id!==r));const a=u.find(d=>d.id===r);if(!a)return;const n=a.name;y(d=>d.map(i=>{const S={...i,results:{...i.results}};return delete S.results[n],Object.keys(S.results).length===0?null:S}).filter(i=>i!==null)),v(d=>d.filter(i=>i.id!==r))},h=E.useCallback(N,[u]),f=()=>{s({campo:"all",busqueda:""})},B=(r,a)=>{s(n=>({...n,[r]:a}))};return e.jsxs("div",{className:"px-1 sm:px-5 md:px-10 lg:px-40 custom:px-0",id:"jurisprudencia-busqueda",children:[e.jsx("div",{className:"row p-4",children:e.jsx("div",{className:"flex flex-col bg-white dark:bg-[#111827] rounded-lg border border-gray-200 dark:border-gray-900  shadow mt-4",children:e.jsxs("div",{className:"w-full p-4 text-center bg-white border border-gray-200 rounded-lg sm:p-8 dark:bg-gray-800  dark:border-gray-900",children:[e.jsxs("form",{className:"w-full flex justify-center items-center flex-row gap-4",children:[e.jsx("div",{className:"max-w-sm mx-auto h-full",children:e.jsxs("select",{id:"countries",onChange:r=>B("campo",r.target.value),value:t.campo,className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:[e.jsx("option",{defaultValue:"all",disabled:!0,children:"Elija una opción"}),e.jsx("option",{value:"proceso",children:"Buscar en Proceso"}),e.jsx("option",{value:"sintesis",children:"Buscar en Síntesis"}),e.jsx("option",{value:"precedente",children:"Buscar en Precedente"}),e.jsx("option",{value:"ratio",children:"Buscar en Ratio"}),e.jsx("option",{value:"restrictor",children:"Buscar en Restrictor"}),e.jsx("option",{value:"proceso",children:"Buscar en Proceso"})]})}),e.jsx("div",{className:"relative flex-1",children:e.jsx("input",{type:"search",id:"default-search",onChange:r=>B("busqueda",r.target.value),value:t.busqueda,className:"block w-full p-4 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Buscar términos clave...",required:!0})})]}),e.jsxs("div",{className:"flex flex-row justify-end gap-4 p-4",children:[e.jsx("div",{children:e.jsx(O,{asyncFunction:m,name:"Generar Serie Temporal",isLoading:p})}),e.jsxs("button",{className:"px-5 py-2.5 text-sm font-medium text-white inline-flex items-center bg-red-octopus-700 hover:bg-red-octopus-600 dark:bg-blue-700 dark:hover:bg-blue-600 focus:ring-4 focus:outline-none focus:ring-red-octopus-300 rounded-lg text-center  dark:focus:ring-blue-800",onClick:f,children:[e.jsx(R,{className:"fill-current w-4 h-4 mr-2"}),e.jsx("span",{children:"Limpiar"})]})]})]})})}),e.jsx("div",{className:"flex flex-row flex-wrap py-4 m-4 gap-4",children:u&&u.length>0&&u.map((r,a)=>e.jsx(P,{item:r,removeItemById:h,data:x},a))}),l&&l.length>0&&e.jsx("div",{className:"p-4 bg-white text-medium text-gray-500 dark:text-gray-400 dark:bg-gray-800 rounded-lg w-full mb-8",children:e.jsx(G,{option:j,border:!1})}),c&&c.length>0&&e.jsx("div",{className:"p-4 bg-white text-medium text-gray-500 dark:text-gray-400 dark:bg-gray-800 rounded-lg h-[600px] mb-8",children:e.jsx(T,{contenido:c})})]})};export{W as default};
