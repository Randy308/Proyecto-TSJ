import{N as M,r as t,j as e,L as J,u as P,O as U,x as G,b as $,P as H,K,Q as k,y as Q}from"./index-BO822pXt.js";import{a as V}from"./index-CygeEBPU.js";import{f as Z}from"./filterForm-BY0rdyPp.js";import{A as W}from"./AsyncButton-BU_jFsPA.js";import"./Icons-CSXVp-DO.js";import"./index-zwMgpmri.js";import"./index-B7Ea7ChQ.js";const X=({currentID:g,setCurrentID:x,arbol:B,setArbol:h})=>{const{nodos:i}=M(),[m,n]=t.useState(null),[d,w]=t.useState(null),[q,S]=t.useState(!1),C=t.useMemo(()=>e.jsx(V,{className:"w-5 h-5"}),[]),b=a=>{const o=i.filter(u=>u.id===a),j=i.filter(u=>u.descriptor_id===o[0].id);if(console.log(j.length),j.length<=0&&o[0].cantidad===0){console.log("No existen resoluciones para este descriptors");return}console.log(o[0].id),h(u=>[...u,o[0]]),x(o[0].id)},E=()=>{if(d===null)return;const a=i.filter(o=>o.id===d);h(o=>o.slice(0,-1)),x(a[0].descriptor_id)};return t.useEffect(()=>{if(i.length>0){const a=i.filter(o=>o.descriptor_id===g);w(g),n(a)}},[i,g]),Array.isArray(m)?e.jsxs("div",{className:"m-2 p-2 custom:p-0 custom:m-0",children:[d&&e.jsx("div",{children:e.jsxs("button",{type:"button",onClick:()=>E(),className:"p-4 m-4 rounded-md text-red-octopus-700 bg-gray-100 hover:border-red-octopus-900 hover:bg-gray-200 border border-gray-300 text-xs flex items-center justify-between gap-4",children:[C,"Regresar"]})}),e.jsx("div",{className:"grid grid-cols-1 sm:flex-wrap sm:flex sm:items-center sm:justify-center gap-4",children:m&&m.length>0?m.map(a=>e.jsxs("div",{className:`p-4 text-xs text-center titulo rounded-lg materia-div hover:cursor-pointer max-w-[300px] flex flex-col gap-4 flex-wrap ${a.cantidad>0||i.some(o=>o.descriptor_id===a.id)?"bg-red-octopus-700  dark:bg-blue-500 dark:hover:bg-blue-700 hover:bg-red-octopus-900 text-white":"bg-gray-100 hidden"}`,id:a.id,onClick:()=>b(a.id),children:[e.jsx("span",{className:"titulo font-medium text-sm",children:a.nombre}),e.jsxs("span",{className:"text-xs text-gray-300",children:["Cantidad:",a.cantidad]})]},a.id)):e.jsx("div",{className:"text-gray-300",children:"No existen mas nodos"})})]}):e.jsx("div",{className:"flex items-center justify-center",style:{height:800},children:e.jsx(J,{})})},ne=()=>{const[g,x]=t.useState(null),{data:B}=P(),[h,i]=t.useState(!1);t.useMemo(()=>e.jsx(U,{className:"w-5 h-5"}),[]);const m=t.useMemo(()=>e.jsx(G,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}),[]),[n,d]=t.useState([]),[w,q]=t.useState([]),[S,C]=t.useState(1),[b,E]=t.useState({fecha_exacta:"",fecha_desde:"",fecha_hasta:"",cantidad:15,subtitulo:"",recorrer:!1,seccion:!1}),[a,o]=t.useState(!1),[j,u]=t.useState([]),[R,y]=t.useState(""),[v,F]=t.useState(""),[p,f]=t.useState([]),A=r=>!!(/^[a-zA-ZáéíóúÁÉÍÓÚñÑ0-9\s'’-]+$/.test(r)||r===""),L=r=>{const s=r.target.value;A(s)?(F(s),y("")):y("No se permiten caracteres especiales")},_=()=>{S==1&&(d([]),x(null))},I=async r=>{if(r.preventDefault(),n.length<=0){Q.error("Seleccione una materia primero");return}const s=n.map(l=>l.nombre).join(" / "),c=Z({tema_id:n[n.length-1].id,descriptor:s,...b});i(!0),k.obtenerCronologia(c).then(({data:l})=>{console.log(l);const N=new Blob([l],{type:"application/pdf"}),z=URL.createObjectURL(N);T("/Jurisprudencia/Cronologias/Resultados",{state:{pdfUrl:z}})}).catch(l=>{const N=l.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",N)}).finally(()=>{i(!1)})},D=async(r,s)=>{try{k.actualizarNodo({busqueda:r}).then(({data:c})=>{c&&(console.log(c),d(c.nodos),x(c.last),f([]),u(s))}).catch(({err:c})=>{console.log("Existe un error "+c)})}catch(c){const l=c.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",l),console.error("Error :",c)}},O=async()=>{if(A(v))try{const r=n.map(({nombre:s})=>s).join(" / ");k.busquedaRapida({busqueda:v,descriptor:r}).then(({data:s})=>{s&&f(s)}).catch(({err:s})=>{console.log("Existe un error "+s),y("No se encontraron resultados"),f([])})}catch(r){const s=r.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",s),console.error("Error :",r)}},T=$();return e.jsxs("div",{id:"cronologia-container",className:"p-4 m-4",children:[e.jsx("div",{className:"header-container",children:e.jsx("div",{children:e.jsx("p",{className:"text-bold text-3xl text-center my-4 titulo uppercase font-bold text-black dark:text-white",children:"Generación de Cronojurídicas"})})}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{children:e.jsxs("div",{children:[e.jsxs("div",{className:"relative w-full mb-4",children:[e.jsx("input",{type:"text",id:"voice-search",value:v,onChange:r=>L(r),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gray-500 focus:border-gray-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Buscar en el árbol jurisprudencial....",required:!0}),e.jsxs("button",{type:"button",onClick:()=>O(),className:"absolute inset-y-0 end-0 flex items-center pe-3",children:[m," "]})]}),R.length>0&&e.jsxs("div",{id:"alert-2",class:"flex items-center p-4 mb-4 text-red-800 rounded-lg  dark:bg-gray-800 dark:text-red-400",role:"alert",children:[e.jsx(H,{class:"shrink-0 w-4 h-4"}),e.jsx("div",{class:"ms-3 text-sm font-medium",children:R})]}),n&&n.length>0&&e.jsxs("div",{className:"p-4 flex items-center justify-between gap-4 flex-wrap",children:[e.jsxs("div",{className:"text-sm flex flex-row items-center flex-wrap gap-2",children:[e.jsx("span",{className:"text-black dark:text-white",children:"Filtrado por:"}),e.jsxs("div",{onClick:()=>_(),className:"bg-white group flex gap-4 items-center justify-between hover:cursor-pointer rounded-lg p-2 font-bold m-4 border hover:border-red-500 text-xs dark:bg-gray-500",children:[e.jsx("span",{children:n.map(({nombre:r})=>r).join(" / ")}),e.jsx(K,{className:"group-hover:text-red-500"})]})]}),e.jsx(W,{asyncFunction:I,name:"Obtener Resoluciones",isLoading:h,full:!1})]}),e.jsx("div",{className:"p-4",children:p&&p.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-800 rounded-md p-3 my-2",children:[e.jsxs("span",{children:["La búsqueda genero:"," ",p.length>1?p.length+" resultados":"un resultado"]}),e.jsx("span",{onClick:()=>f([]),className:"cursor-pointer underline",children:"Limpiar Resultados"})]}),p.map((r,s)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 hover:dark:bg-gray-700 hover:bg-gray-200 rounded-md p-3 my-2 cursor-pointer transition-all ease-in-out duration-200",onClick:()=>D(r.descriptor,r.ids),children:[e.jsx("span",{className:"text-black font-semibold dark:text-white ",children:r.descriptor}),e.jsx("span",{className:"text-gray-600 text-sm dark:text-gray-400",children:r.cantidad})]},s))]}):e.jsx(X,{currentID:g,setCurrentID:x,setArbol:d,arbol:n})})]})})})]})};export{ne as default};
