import{a as oe,r as o,j as e,v as le,c as ne,K as N,y as b,Q as ce,J as ie,B as $,z as de,S as ue}from"./index-CS51DAse.js";import{f as y,a as xe,b as me,c as ge}from"./filterForm-qRQJ7N12.js";import{F as he}from"./Filtros-CtHZOVzw.js";import{P as pe}from"./PortalButton-C9pukmzI.js";import{P as fe}from"./Paginate-CeUBiUk8.js";import{R as be}from"./ResolucionTSJ-DtgqibEw.js";import{A as je}from"./AsyncButton-O7CY9z2J.js";import{u as ve}from"./Icons-Beyyzlav.js";import"./Login-DbIr_fTM.js";import"./index-Bjhrrt2E.js";import"./index-BBE9PvKj.js";const Ae=()=>{const{data:k}=oe(),m=40,[q,w]=o.useState(!1),M=o.useMemo(()=>e.jsx(le,{className:"w-4 h-4 "}),[]),[j,C]=o.useState(null),[S,_]=o.useState(""),[T,O]=o.useState({}),[g,I]=o.useState(!0),[h,R]=o.useState({}),z=ne(),[J,F]=o.useState(1),[H,U]=o.useState(1),[Q,D]=o.useState(1),[G,A]=o.useState(1),[p,P]=o.useState([]),{removeAllIcon:K,checkAllIcon:V}=ve(),[l,f]=o.useState([]),[B,n]=o.useState(""),[c,L]=o.useState(""),[i,d]=o.useState([]),E=s=>!!(/^[a-zA-ZáéíóúÁÉÍÓÚñÑ0-9\s'"’-]+$/.test(s)||s===""),Y=s=>{const r=s.target.value;E(r)?(L(r),n("")):n("No se permiten caracteres especiales")},Z=s=>{C(Number.parseInt(s.descriptor_id)),_(s.descriptor),d([]),R(r=>({...r,materia:[Number.parseInt(s.root_id)]}))},W=async s=>{if(s.preventDefault(),l.length<=0){b.error("Debe agregar resoluciones");return}const r=y({descriptor:j,ids:l,materia:g,...h});w(!0),N.obtenerCronologiabyIds(r).then(({data:a})=>{console.log(a);const t=new Blob([a],{type:"application/pdf"}),u=URL.createObjectURL(t);z("/Jurisprudencia/Cronologias/Resultados",{state:{pdfUrl:u}})}).catch(a=>{const t=a.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",t)}).finally(()=>{w(!1)})},X=async()=>{if(!E(c))return;if(g){v();return}if(c.length<1){n("Debe ingresar un término de búsqueda");return}const s=y({busqueda:c});try{N.searchTermino(s).then(({data:r})=>{r.length>0?(d(r),n("")):(n("No se encontraron resultados"),d([]))}).catch(({err:r})=>{console.log("Existe un error "+r),n("No se encontraron resultados"),d([])})}catch(r){let a="Ocurrió un error";typeof r=="object"&&r!==null&&"response"in r&&(a=r.response?.data?.error||a),console.error("Error fetching data:",a),console.error("Error :",r)}};o.useEffect(()=>{v()},[h]);const v=async(s=1)=>{const r=s&&!isNaN(s)&&s>0?s:1,a=y({busqueda:c,page:r,descriptor:j,strategy:!1,...h});P([]),F(1),D(1),A(1),N.obtenerResoluciones(a).then(t=>{t.data.data.length>0?(P(t.data.data),O(xe(t.data.facets,k||{})),F(t.data.last_page),D(t.data.last_page),A(t.data.total)):b.warning("No existen datos")}).catch(t=>{const u=t.response?.data?.error||"Ocurrió un error";console.error("Error fetching data:",u)})},ee=s=>{const r=Math.min(s,J);U(s),v(r)},se=s=>{const r=Number(s.target.value);f(a=>a.includes(r)?a.filter(t=>t!==r):l.length>=m?(b.error(`No puede seleccionar más de ${m} resoluciones. Por favor, deseleccione algunas antes de continuar.`),a):[...a,r])},re=s=>{s.preventDefault();const a=p.map(x=>Number(x.resolution_id)).filter(x=>!l.includes(x)),t=m-l.length;if(t<=0){b.error("Ya alcanzaste el límite de resoluciones seleccionadas");return}const u=a.slice(0,t);f(x=>{const te=new Set([...x,...u]);return Array.from(te)})},ae=s=>{s.preventDefault(),f(r=>r.filter(a=>!p.some(t=>Number(t.resolution_id)===a)))};return e.jsxs("div",{id:"cronologia-container",className:"sm:p-4 sm:m-4 m-2 p-2",children:[e.jsx("div",{className:"header-container",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-bold text-3xl text-center my-4 titulo uppercase font-bold text-black dark:text-white",children:"Generación de Cronojurídicas"}),e.jsx("div",{className:"flex justify-end items-center flex-wrap gap-4 mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"voice-search",value:c,onChange:s=>Y(s),className:"bg-gray-50 h-full border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-red-octopus-500 focus:border-red-octopus-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-red-octopus-500 dark:focus:border-red-octopus-500",placeholder:"Búsqueda de jurisprudencia....",required:!0}),c.length>0&&e.jsx("a",{className:"absolute inset-y-0 end-0 flex items-center justify-center pe-3 hover:cursor-pointer",onClick:()=>L(""),children:e.jsx(ce,{})})]}),e.jsxs("button",{type:"button",onClick:()=>X(),className:"flex items-center bg-red-octopus-600 p-4 text-white rounded-lg hover:bg-red-octopus-700 focus:ring-4 focus:ring-red-octopus-300 dark:focus:ring-red-octopus-800",children:[M," "]})]}),e.jsxs("div",{className:"flex flex-row flex-wrap items-center md:justify-end gap-4 mt-2 text-lg text-black dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center",children:[" ",e.jsx("input",{type:"radio",value:"res",id:"checkbox-res",checked:g,onChange:()=>I(!0),className:"peer"}),e.jsx("label",{htmlFor:"checkbox-res",children:"Buscar resoluciones"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"desc",id:"checkbox-desc",checked:!g,onChange:()=>I(!1),className:"peer"}),e.jsx("label",{htmlFor:"checkbox-desc",children:"Buscar descriptores"})]})]})]})})]})}),e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"w-full",children:B.length>0&&e.jsxs("div",{id:"alert-2",className:"flex items-center p-4 mb-4 text-red-800 rounded-lg  dark:bg-gray-800 dark:text-red-400",role:"alert",children:[e.jsx(ie,{className:"shrink-0 w-4 h-4"}),e.jsx("div",{className:"ms-3 text-sm font-medium",children:B})]})})}),j&&S&&e.jsx("div",{className:"py-4 flex items-center justify-end gap-4 flex-wrap",children:e.jsxs("div",{className:"text-sm flex flex-row items-center flex-wrap gap-2",children:[e.jsx("span",{className:"text-black dark:text-white",children:"Descriptor:"}),e.jsxs("div",{onClick:()=>{C(null),_("")},className:"bg-white group flex gap-4 items-center justify-between hover:cursor-pointer rounded-lg p-2 font-bold m-4 border hover:border-red-500 text-xs dark:bg-gray-500",children:[e.jsx("span",{children:S}),e.jsx($,{className:"group-hover:text-red-500"})]})]})}),l&&l.length>0&&e.jsxs("div",{className:"py-4 flex items-center justify-end gap-4 flex-wrap",children:[e.jsxs("div",{className:"text-sm flex flex-row items-center flex-wrap gap-2",children:[e.jsx("span",{className:"text-black dark:text-white",children:"Resoluciones seleccionadas:"}),e.jsxs("div",{onClick:()=>f([]),className:"bg-white group flex gap-4 items-center justify-between hover:cursor-pointer rounded-lg p-2 font-bold m-4 border hover:border-red-500 text-xs dark:bg-gray-500",children:[e.jsxs("span",{children:[l.length+"/"+m," "]}),e.jsx($,{className:"group-hover:text-red-500"})]})]}),e.jsx(je,{asyncFunction:W,name:"Obtener Resoluciones",isLoading:q,full:!1})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-4 pt-4",children:i&&i.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-800 rounded-md p-3 my-2",children:[e.jsxs("span",{children:["La búsqueda genero:"," ",i.length>1?i.length+" resultados":"un resultado"]}),e.jsx("span",{onClick:()=>d([]),className:"cursor-pointer underline",children:"Limpiar Resultados"})]}),i.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center bg-gray-50 dark:bg-gray-700 hover:dark:bg-gray-700 hover:bg-gray-200 rounded-md p-3 my-2 cursor-pointer transition-all ease-in-out duration-200",onClick:()=>Z(s),children:[e.jsx("span",{className:"text-black font-semibold dark:text-white ",children:s.descriptor}),e.jsx("span",{className:"text-gray-600 text-sm dark:text-gray-400",children:s.cantidad})]},r))]}):e.jsxs("div",{className:"flex flex-row flex-wrap gap-4",children:[e.jsx("div",{className:"lg:w-auto w-full",children:Object.entries(T).map(([s,r])=>e.jsx(he,{nombre:s,data:r,formData:h,setFormData:R},s))}),e.jsx("div",{className:"lg:flex-1",children:e.jsx(e.Fragment,{children:p.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative overflow-x-auto space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2",children:[e.jsxs("a",{onClick:s=>re(s),className:"dark:bg-gray-800 dark:border-gray-700 inline-flex items-center justify-between border hover:cursor-pointer border-gray-200 p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700",children:[V,e.jsx("span",{className:"ms-2 text-xs",children:"Seleccionar todos"})]}),e.jsxs("a",{onClick:s=>ae(s),className:"dark:bg-gray-800 dark:border-gray-700 inline-flex items-center border hover:cursor-pointer border-gray-200 p-2 text-gray-900 rounded-lg dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 group",children:[K,e.jsx("span",{className:"ms-2 text-xs",children:"Quitar Selección"})]})]}),e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:p.map((s,r)=>e.jsxs("div",{className:`relative p-6 rounded-2xl bg-white dark:bg-gray-900 shadow-md border-2 hover:shadow-lg transition ${l.includes(Number(s.resolution_id))?"border-blue-400 dark:border-blue-900":"border-gray-100"}`,children:[e.jsx("input",{type:"checkbox",id:`checkbox-${s.resolution_id}`,value:s.resolution_id,checked:l.includes(Number(s.resolution_id)),onChange:se,className:"hidden peer","aria-label":`Seleccionar resolución ${s.nro_resolucion}`}),l.includes(Number(s.resolution_id))?e.jsx("label",{htmlFor:`checkbox-${s.resolution_id}`,className:"hover:cursor-pointer text-blue-700",children:e.jsx(de,{className:"h-7 w-7"})}):e.jsx("label",{htmlFor:`checkbox-${s.resolution_id}`,className:"hover:cursor-pointer text-gray-400 dark:text-gray-500",children:e.jsx(ue,{className:"h-7 w-7"})}),e.jsx("div",{className:"mt-2 flex justify-center text-center text-xl",children:e.jsx(pe,{withIcon:!1,title:"Auto Supremo",name:`${me(String(s.tipo_resolucion),"tipo_resolucion",k||{})} Nº${ge(s.nro_resolucion)}`,color:"link",full:!1,large:!0,content:()=>e.jsx(be,{id:Number(s.resolution_id)})})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-700 dark:text-gray-300",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Periodo:"})," ",s.periodo]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Ratio:"}),e.jsx("div",{className:"pl-2 mt-1 border-l-4 border-blue-500 dark:border-blue-400",dangerouslySetInnerHTML:{__html:s.ratio}})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Descriptor:"}),e.jsx("div",{className:"pl-2 mt-1 border-l-4 border-green-500 dark:border-green-400",dangerouslySetInnerHTML:{__html:s.descriptor}})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Restrictor:"}),e.jsx("div",{className:"pl-2 mt-1 border-l-4 border-red-500 dark:border-red-400",dangerouslySetInnerHTML:{__html:s.restrictor}})]})]})]})]},r))})]}),e.jsx("div",{className:"mt-6",children:e.jsx(fe,{handlePageClick:ee,pageCount:Q,actualPage:H,totalCount:G})})]})})})]})}),e.jsx("div",{})]})]})};export{Ae as default};
